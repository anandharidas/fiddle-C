<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>fiddleC</title>

    <!-- Bootstrap Core CSS -->
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet">
     <link rel="stylesheet" type="text/css" href="https://cdn.rawgit.com/codemirror/CodeMirror/master/lib/codemirror.css">
     <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
        <script type="text/javascript" src="https://cdn.rawgit.com/codemirror/CodeMirror/master/lib/codemirror.js"></script>
        <!-- <script type="text/javascript" src="https://cdn.rawgit.com/codemirror/CodeMirror/master/mode/xml/xml.js"></script> -->
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.16.0/mode/javascript/javascript.min.js"></script>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.16.0/theme/pastel-on-dark.css" type="text/css">
    
    <script type="text/template" id="title-template">
        <div class="view" >
                <span class="not-selected row" id="<%= id %>" "> <%- snip.Title %> </span>
                <br>
        </div>
    </script>  
    <script type="text/template" id="code-template">
        <div class="view">
                <textarea class = "code" id="code" name ="code" type="text" style=""><%- code %></textarea>
        </div>
    </script>
<style type="text/css">
  
</style>   
 <style type="text/css">
  .overlay{
    background: black;  
    position: absolute;   
    top: 0;               
    right: 0;             
    bottom: 0;
    left: 0;
    opacity: 0.8;
    z-index: 40000;
  }
   .container{
    margin: 0px;
    position: absolute;
    bottom: 0px;
    left: 0px;
    top:0px;
    right:450px;
    width: 100%; 
   }
    .CodeMirror {
    min-height: 43em;
    }
    .row{
        height: 100%;
        margin-left:-15px;
    }
    .col-md-3{
        width: 10%;
        height: 100%;
        overflow-y: auto;
        background-color: #34302f;
        border-right: thin solid #504c49;
        border-left: thin solid #2F2F2F;
        color:#8fc13e;
        padding-left: 1%;
    }
    .waste{
      width:15%;
      height: 100%;
      z-index: 20;
      overflow-y: hidden;
      background-color:  #d6d5d4;
      border-right: thin solid #d6d5d4;
      border-left: thin solid white;
    }
    .col-md-6 {
      width:75%;
      border-left: 1px solid black;
      border-right: 1px solid black;
      border-bottom: thin solid #5c5855;
      border-top: thin solid #5c5855;
      height:100%;
      overflow-y:auto;
      background: #34302f;
      padding: 0px 0px 0px 0px;
      z-index: 20;
    }
    .codearea{
      position: relative;
      padding-left: 0px;
    }
    
    .selected{
      background-color: #2c2827;
      width: 100%;
      height: 100%;
      color: white;
    }
    .save{
      color: white;
     
    }
    .save:hover {
      color:#5c5855;
    }
    .options{
      padding-left: 4%;
      padding-top: 1.5%;
      padding-bottom: 1%;
    }
    .form-control:focus{
      border-color: #5c5855;
      box-shadow: 0 1px 1px #5c5855 inset, 0 0 1px black;
    }
    .fa-github{
        color: #34302f;  
        /*color: white;*/
    }
    .fa-github:hover{
        /*color: #34302f;  */
        color: white;
    }
    #codes-list{
      padding-left: 8%;
      padding-top: 3%;
    }
    .spinner {
  /*margin: 100px auto;*/
  /*width: 40px;*/
  /*height: 40px;*/
  /*position: relative;*/
  position: absolute;
    height: 90px;
    width: 280px;
    margin: -100px 0 0 -200px;
    top: 50%;
    left: 50%;
}
.cube1, .cube2 {
  background-color: white;
  width: 15px;
  height: 15px;
  position: absolute;
  top: 50%;
  left: 50%;
  
  -webkit-animation: sk-cubemove 1.8s infinite ease-in-out;
  animation: sk-cubemove 1.8s infinite ease-in-out;
}
.cube2 {
  -webkit-animation-delay: -0.9s;
  animation-delay: -0.9s;
}
@-webkit-keyframes sk-cubemove {
  25% { -webkit-transform: translateX(42px) rotate(-90deg) scale(0.5) }
  50% { -webkit-transform: translateX(42px) translateY(42px) rotate(-180deg) }
  75% { -webkit-transform: translateX(0px) translateY(42px) rotate(-270deg) scale(0.5) }
  100% { -webkit-transform: rotate(-360deg) }
}
@keyframes sk-cubemove {
  25% { 
    transform: translateX(42px) rotate(-90deg) scale(0.5);
    -webkit-transform: translateX(42px) rotate(-90deg) scale(0.5);
  } 50% { 
    transform: translateX(42px) translateY(42px) rotate(-179deg);
    -webkit-transform: translateX(42px) translateY(42px) rotate(-179deg);
  } 50.1% { 
    transform: translateX(42px) translateY(42px) rotate(-180deg);
    -webkit-transform: translateX(42px) translateY(42px) rotate(-180deg);
  } 75% { 
    transform: translateX(0px) translateY(42px) rotate(-270deg) scale(0.5);
    -webkit-transform: translateX(0px) translateY(42px) rotate(-270deg) scale(0.5);
  } 100% { 
    transform: rotate(-360deg);
    -webkit-transform: rotate(-360deg);
  }
}
    </style>
</head>
<body>
    <!-- Navigation -->
<div class="overlay">
</div>
 <div class="spinner" id="spinner" style="z-index:40000;">
    <div class="cube1"></div>
    <div class="cube2"></div>
  </div>
    <!-- Page Content -->
    <form class="editor" action="/codes" method="POST">
    <div class="container" style="">
        <div class="row" style="">
            <div class="col-md-3" style="">
                <h2 onclick="window.location.href="/" " class="" style="font:'Ubuntu medium';color: #8F938F;text-align:center;font-weight:bold;">fiddleC</h2>
                <hr>
                <div style="z-index:40000;">
                    <br>
                     <ul id="codes-list">
                            
                    </ul> 
                </div>
               
            </div>
            
            <div class="col-md-6">
                            <div class="options">
                            <a href="#" title="Save snippet!" class = "save " onclick=" validateForm();"><span class="glyphicon glyphicon-save"></span></a>
                            </div>
            
                <div class ="codearea" >      
                        
                </div>
            </div>
            <div class ="col-md-3 waste text-center" class="tit">
            <br>
            <input type="text" placeholder="Enter a title for the code... " class = "form-control" name="Title" id="title" style="" required="">
            <br>
            <br>
            <br>
            <br>
              <a class="btn btn-social-icon btn-github" style="z-index:30000;" href="https://github.com/jats22/fiddle-C" title="Fork me!">
                <span class="fa fa-github fa-5x row" style="font-size:10em;"></span>
              </a>
            </div>
            
        </div>
    </div>
    </form>
     <!-- </form> -->
    <!-- <div class="container"> -->
    <!-- </div> -->
    <script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.3.3/underscore-min.js" type="text/javascript"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/backbone.js/0.9.2/backbone-min.js" type="text/javascript"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/backbone-localstorage.js/1.0/backbone.localStorage-min.js" type="text/javascript"></script>  
    <script type="text/javascript">
        var CMInit = function(){
          var editors = document.getElementsByClassName("code");
          for(i=0;i<editors.length;i++){
           var editor = CodeMirror.fromTextArea(editors[i], {
            lineNumbers: true,
            mode:  'javascript',
            lineWrapping: true,
            theme: 'pastel-on-dark',
            lineNumbers: true,
            viewportMargin: Infinity
          });
         }};
        var validateForm = function(){
            var formTit = $('#title').val();
            if(formTit == null || formTit == "") {
                window.alert("Title is a must!");
            }
              else{
                $('.editor').submit();
           } 
        }
    </script>
    <script type="text/javascript">
        
    var app = {};
    var SnipModel; 
    
    var $loading = $('#spinner').hide();
    $(document)
    .ajaxStart(function(){
      $loading.show();
      $('.overlay').show();
    })
    .ajaxStop(function(){
      $loading.hide();
      $('.overlay').hide();
    });
    var select  = 0;
    $(function(){
           
           $.ajax({
            url:'http://localhost:3000/codes',
            data : {
                format : 'json'
            },
            error:function(){
                window.alert("Couldnt get data!");
                var Codetemplate = _.template($('#code-template').html());
                    Codetemplate = Codetemplate({code :"//Write Code Here..."});
                    $('.codearea').empty().append(Codetemplate);
                CMInit();
            },
            success:function(data){
                SnipModel =  data;
                if(SnipModel.length){
                for(var i=0;i<SnipModel.length;i++){
                  var compTemplate = _.template($('#title-template').html());
                  var renTemp = compTemplate({ id : i , snip : SnipModel[i] });
                  var elem = $(renTemp);
                  $('#codes-list').append(elem);
                };
                $('#codes-list').on('click','span',function(){
                    $('#codes-list').find('span').removeClass('selected');
                    
                    var elem = $(this);
                    
                    elem.addClass('selected');
                    
                    var id = elem.attr('id');
                    var Codetemplate = _.template($('#code-template').html());
                    Codetemplate = Codetemplate(SnipModel[id]);
                    $('#title').val($('#'+id).text())
                    $('.codearea').empty().append(Codetemplate);
                    CMInit();
                });
               
                $('#0').click();
              }
              else{
                // Write this.
                var Codetemplate = _.template($('#code-template').html());
                Codetemplate = Codetemplate({code :"//Write Code Here..."});
                $('.codearea').empty().append(Codetemplate);
                CMInit();
              }
            },
            type: 'GET'
           });
    });
        
        // console.log(view.render().el);
    </script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
</body>
</html>