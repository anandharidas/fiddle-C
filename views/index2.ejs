<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>fiddleCPP</title>

    <!-- Bootstrap Core CSS -->
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet">
     <link rel="stylesheet" type="text/css" href="https://cdn.rawgit.com/codemirror/CodeMirror/master/lib/codemirror.css">
     <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
        <script type="text/javascript" src="https://cdn.rawgit.com/codemirror/CodeMirror/master/lib/codemirror.js"></script>
        <!-- <script type="text/javascript" src="https://cdn.rawgit.com/codemirror/CodeMirror/master/mode/xml/xml.js"></script> -->
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.16.0/mode/javascript/javascript.min.js"></script>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.16.0/theme/pastel-on-dark.css" type="text/css">
    
    <script type="text/template" id="title-template">
        <div class="view">
                <label class="edit"> <%- title %> </label>
                <br>  
        </div>
    </script>  
    <script type="text/template" id="code-template">
        <div class="view">
            <form id="editor" action="/codes" method="POST">
                <textarea class = "code" id="code" name ="code" type="text" style=""><%- code %></textarea>
            </form>
        </div>
    </script>  
   
<style type="text/css">
   .container{
    margin: 0px;
    position: absolute;
    bottom: 0px;
    left: 0px;
    top:0px;
    right:450px;
    width: 100%; 

   }

    .CodeMirror {
    min-height: 43em;
    }
    .row{
        height: 100%;
        margin-left:-15px;
    }
    .col-md-3{
        width: 10%;
        height: 100%;
        overflow-y: auto;
        background-color: #34302f;
        border-right: thin solid #504c49;
        border-left: thin solid #2F2F2F;
        color:#8fc13e;
        padding-left: 1%;
    }
    .waste{
      width:15%;
      height: 100%;
      z-index: 20;
      overflow-y: hidden;
      background-color:  #d6d5d4;
      border-right: thin solid #d6d5d4;
      border-left: thin solid white;
    }
    .col-md-6 {
      width:75%;
      border-left: 1px solid black;
      border-right: 1px solid black;
      border-bottom: thin solid #5c5855;
      border-top: thin solid #5c5855;
      height:100%;
      overflow-y:auto;
      background: #34302f;
      padding: 0px 0px 0px 0px;
      z-index: 20;
    }
    .codearea{
      position: relative;
      padding-left: 0px;
    }
    
    .selected{
      background-color: #2c2827;
      width: 100%;
      height: 100%;
      color: white;
    }
    .save{
      color: white;
     
    }
    .save:hover {
      color:#5c5855;
    }
    .options{
      padding-left: 4%;
      padding-top: 1.5%;
      padding-bottom: 1%;
    }
    .form-control:focus{
      border-color: #5c5855;
      box-shadow: 0 1px 1px #5c5855 inset, 0 0 1px black;
    }
    .fa-github{
        color: #34302f;  
        /*color: white;*/
    }
    .fa-github:hover{
        /*color: #34302f;  */
        color: white;
    }
</style>

</head>

<body>

    <!-- Navigation -->
   

    <!-- Page Content -->
    <div class="container" style="">

        <div class="row" style="">

            <div class="col-md-3 text-center" style="">
                <p class="lead"></p>
                <div>
                     <ul id="codes-list">
                            
                    </ul> 

                </div>
               
            </div>

            <div class="col-md-6">
                            <div class="options">
                            <a href="#" title="Save snippet!" class = "save " onclick=" validateForm();"><span class="glyphicon glyphicon-save"></span></a>
                            </div>
                <div class ="codearea" >      
                        
                </div>

            </div>
            <div class ="col-md-3 waste text-center">
            <br>
            <input type="text" placeholder="Enter a title for the code... " class = "form-control" name="Title" style="" required="">
            <br>
            <br>
            <br>
            <br>
              <a class="btn btn-social-icon btn-github" style="z-index:30000;" href="https://github.com" title="Fork me!">
                <span class="fa fa-github fa-5x row" style="font-size:10em;"></span>
              </a>
            </div>

        </div>

    </div>
     <!-- </form> -->
    <div class="container">

    </div>
    <script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.3.3/underscore-min.js" type="text/javascript"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/backbone.js/0.9.2/backbone-min.js" type="text/javascript"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/backbone-localstorage.js/1.0/backbone.localStorage-min.js" type="text/javascript"></script>  
    <script type="text/javascript">
          var editors = document.getElementsByClassName("code");
          for(i=0;i<editors.length;i++){
           var editor = CodeMirror.fromTextArea(editors[i], {
            lineNumbers: true,
            mode:  'javascript',
            lineWrapping: true,
            theme: 'pastel-on-dark',
            lineNumbers: true,
            viewportMargin: Infinity
          });
         }
         var validateForm = function(){
            var formmm = document.getElementById('editor');
            if(formmm["Title"].value == null || formmm["Title"].value == "") {
                window.alert("Title is a must!");
            }
              else{
                formmm.submit();
           } 
         }
         // window.dataRecieved = null;
         // <% dataRecieved =  codes %>
         // console.log(dataRecieved);
// var update = document.getElementById('update');
// var request;
// update.addEventListener('click',function(){
// data =  JSON.stringify({
//     'name': 'Darth Vader',
//     'quote': 'says Bye'
//   });
// console.log(this);
// FIX THIS
// request = new XMLHttpRequest();
// request.open('POST', 'http://localhost:3000/quotes', true);
// request.setRequestHeader('Content-Type', 'application/json');
// request.send(data);
// request.onreadystatechange = function () {                         // while waiting response from server
        
//     if (request.readyState === 4) {                // 4 = Response from server has been completely loaded.
//         if (request.status == 200 && request.status < 300){ // http status between 200 to 299 are all successful
//               // alert("success");
//               window.location.href = 'http://localhost:3000';
//             }
//     }
// });
    </script>
    <script type="text/javascript">
        var app = {};
        app.Snippet = Backbone.Model.extend({
            defaults : {
                title : 'Title',
                code:'//Write code Here'
            }
        });

        app.SnipList = Backbone.Collection.extend({
            model : app.Snippet,
            localStorage : new Store("SnipStore"),

        });

        app.snipList = new app.SnipList();

        app.TitleView = Backbone.View.extend({
            tagName : 'li',
            template: _.template($('#title-template').html()),

            initialize : function(){
                this.render();
                this.model.on('change',this.render,this);
            },
            render: function(){
                this.$el.html(this.template(this.model.toJSON()));
                return this;
            },
            events:{
                'click label' : 'editingCode'
                // 'blur .title-view' : 'close'
            },

            editingCode : function(){
                window.alert("works");
                this.$el.addClass('selected');
            },
            close :function(){
                this.$el.removeClass('selected');
            }
        });
        var mod  = new app.Snippet({title:'First code',code:'return 0;'});

        var view = new app.TitleView({model : mod});

        $('#codes-list').append(view.render().el);
        // console.log(view.render().el);

    </script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

</body>

</html>